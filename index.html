<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Relational Model of Interaction</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="assets/svg2pdf.js/dist/svg2pdf.umd.min.js"></script>

    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"
      integrity="sha512-csNcFYJniKjJxRWRV1R7fvnXrycHP6qDR21mgz1ZP55xY5d+aHLfo9/FcGDQLfn2IfngbAHd8LdfsagcCqgTcQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <script type="module" src="input.js"></script>
    <script type="module" src="display.js"></script>
    <!-- <script type="module" src="permutate.js"></script> -->
    <script type="module" src="randomise.js"></script>
    <script src="addcom.js" defer></script>
    <script src="addact.js" defer></script>
    <script src="addele.js" defer></script>
    <script src="addcond.js" defer></script>
    <script src="addeffect.js" defer></script>
    <script src="interface.js"></script>
    <script type="module" src="admin.js"></script>
    <script type="module" src="legends.js"></script>
    <script type="module" src="savepdf.js"></script>
    <script type="module" src="sketch.js" defer></script>
  </head>
  <style>
    body {
      font-family: "Courier New", Courier, monospace;
      font-size: 18px;
      width: auto;
      height: auto;
      padding: 0;
      margin: 0;
      margin: 0;
      display: inline-flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    div {
      margin: 0;
      padding: 0;
    }
    #instruction_text {
      display: none;
      position: fixed;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 14px;
      width: 40%;
      height: auto;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px;
      background-color: #fff;
      border: 1px solid #ccc;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      z-index: 1000;
    }
    #select {
      position: fixed;
      z-index: 100;
      box-sizing: border-box;
      width: 100%;
      height: 80px;
      overflow: visible;
      margin: 0;
      padding: 15px;
      background-color: white;
    }
    .top_buttons {
      position: relative;
      display: inline-block;
    }
    .top_buttons:hover .info {
      visibility: visible;
    }
    .top_block {
      font-family: Arial, Helvetica, sans-serif;
      font-size: 16px;
      display: inline-flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    .top_link {
      font-size: 16px;
      margin: 10px 0 0 0;
      padding: 0;
      border: none;
      background-color: white;
      text-decoration: underline;
      cursor: pointer;
    }
    #all_elements {
      flex-direction: column;
      justify-content: flex-start;
      padding: 5px;
      display: none;
      background-color: white;
      border: 1px solid black;
    }
    #spacer {
      width: 100%;
      height: 90px;
    }
    #input {
      display: inline-flex;
      width: auto;
      height: auto;
      /* border: 1px solid rgb(156, 155, 155); */
    }
    #footnote {
      display: inline-flex;
      width: auto;
      height: auto;
      margin: 0 0 0 10px;
      /* border: 1px solid rgb(156, 155, 155); */
    }
    .footnote_text {
      position: relative;
      display: inline-block;
      font-size: 14px;
    }
    #controls {
      display: inline-flex;
      margin-top: 20px;
      margin-bottom: 20px;
      padding: 10px;
      width: auto;
      height: auto;
      /* border: 1px solid rgb(156, 155, 155); */
    }
    .control_block {
      width: 200px;
      height: auto;
      /* border: 1px solid; */
    }
    .control_button {
      float: right;
      font-size: 20px;
      padding: 10px;
      width: 125px;
    }
    .element_info {
      position: fixed;
      z-index: 50;
      font-size: 12px;
      padding: 2px;
      width: auto;
      height: auto;
      border: 1px solid burlywood;
      background-color: blanchedalmond;
    }
    #footnote_container,
    .element,
    .annotation,
    .add_element {
      position: relative;
      display: inline-flex;
      flex-direction: column;
      justify-content: flex-start;
      width: auto;
      border: 1px dashed;
      padding: 10px;
      margin: 5px;
    }
    .annotation {
      border: 0;
      text-align: right;
      vertical-align: bottom;
      padding: 15px 0 0 0;
      margin: 0;
      background-color: white;
    }
    .add_element {
      padding-top: 15px;
      /* width: auto; */
    }
    #add_element {
      font-size: 16px;
      padding: 10px;
    }
    .allactions {
      display: flex;
      justify-content: flex-start;
      /* border: 1px solid pink; */
      padding: 0;
    }
    #actionV {
      width: 150px;
    }
    .add_action,
    .action {
      position: relative;
      display: inline-flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: flex-end;
      /* margin-top: 5px;
      margin-bottom: 5px; */
      margin-right: 8px;
      padding: 7px;
      width: 335px;
      height: auto;
      /* border: 1px solid; */
      background-color: rgb(220, 220, 220);
      font-size: 16px;
    }
    .add_action {
      width: 80px;
      margin-right: 0;
    }
    .anno_action {
      display: inline-flex;
      flex-direction: column;
      justify-content: flex-start;
      margin-top: 5px;
      /* margin-bottom: 5px; */
      width: auto;
      height: auto;
      /* border: 1px solid red; */
    }
    .com {
      display: flex;
      width: auto;
      height: auto;
      padding: 0px;
      /* border: 1px solid red; */
    }
    .an_com,
    .add_communication,
    .communications {
      position: relative;
      display: inline-flex;
      flex-direction: column;
      justify-content: flex-start;
      margin: 5px;
      margin-left: 0;
      padding: 5px;
      width: 250px;
      height: auto;
      /* border: 1px solid yellowgreen; */
      background-color: white;
    }
    .an_com {
      background-color: rgb(220, 220, 220);
      margin-right: 0;
      padding-left: 0;
      width: 63px;
    }
    .ancom_block {
      position: relative;
      display: inline-block;
      cursor: pointer;
      font-size: 16px;
      width: 65px;
      height: auto;
      /* border: 1px solid; */
      margin: 4px 0 5px 0;
      text-align: right;
      vertical-align: bottom;
    }
    .ancom_block:hover .info {
      visibility: visible;
    }
    #com_num,
    #config_from,
    #config_to {
      width: 53px;
    }
    .anno_block,
    .act_block,
    .block {
      width: 240px;
      height: auto;
      /* border: 1px solid; */
      margin: 3px;
    }
    .act_block {
      position: relative;
      width: 98%;
    }
    .anno_block {
      width: 120px;
      position: relative;
      display: inline-block;
      cursor: pointer;
    }
    .info {
      position: absolute;
      visibility: hidden;
      z-index: 50;
      font-size: 12px;
      font-weight: normal;
      padding: 5px;
      width: 200px;
      height: auto;
      text-align: left;
      color: black;
      border: 1px solid burlywood;
      background-color: blanchedalmond;
    }
    .anno_block:hover .info {
      visibility: visible;
    }
    #index {
      text-align: center;
      font-size: 20px;
      font-weight: bold;
    }
    #vis {
      position: relative;
      display: inline-flex;
    }
    #container {
      margin: 0 5px 25px 25px;
      border: 2px solid;
      font-family: Arial, Helvetica, sans-serif;
      overflow: visible;
    }
    #savePDF {
      position: absolute;
      width: 100px;
      font-size: 16px;
      top: 650px;
      left: 1160px;
      z-index: 100;
    }
    #vis_anno {
      margin: 0 25px 25px 5px;
      border: 2px solid;
      font-family: Arial, Helvetica, sans-serif;
      overflow: visible;
    }
    .close {
      position: absolute;
      padding: 0;
      right: 3px;
      top: 3px;
      width: 18px;
      height: 18px;
      text-align: center;
      background: none;
    }
    .effect {
      width: 235px;
      resize: none;
    }
    .effect_container {
      display: inline-flex;
      flex-direction: column;
    }
    .add_effect {
      width: 30px;
    }
  </style>
  <body>
    <div id="select">
      <div>
        <button
          id="instruction"
          onclick="showInstruction(this)"
          style="font-size: 16px"
        >
          *Instruction*
        </button>
        <div id="instruction_text">
          <button class="close" onclick="closeInstruction(this)">X</button>
          This site presents a modelling tool for describing, visualising and
          creating interactions among various elements, including both humans
          and non-humans. This tool is built upon a relational model previously
          proposed for describing different forms of interaction in the context
          of interactive artworks. A detailed description of the model can be
          found in
          <a
            href="/resources/ISEA2023_towards a relational model of interaction.pdf"
            target="_blank"
            >this paper</a
          >. The model starts by identifying the individual actors participating
          in the interaction each referred to as an element. To describe an
          interaction, the model examines the actions performed by the elements
          that influence other elements. Following an action, one or more forms
          of communication are created and directed at (an)other element(s). The
          means of communication can be either direct or mediated. The access to
          communication can be either public or private. Finally, the model
          examines the effects of communication on the interaction, such as its
          functions and impacts on other elements.
          <br />
          <br />
          <span style="font-weight: bold">How to use the tool:</span><br />
          You can either directly work on an empty worksheet or browse the
          database to load existing interactive artworks for inspirations.
          Before you start, please name the current worksheet, such as 'Artwork
          Title (year) by Artist'. This allows you to store the data in the
          database and reload the worksheet data using the same name.
          <br />
          <br />
          While working on the worksheet, you can hover over the various terms
          used in the relational model to view brief explanations. Clicking on
          certain text fields will prompt a suggestion list based on database
          data. You may select an option from the list or input new content as
          desired. If no visualisation was shown after clicking on the visulise
          button, there may be important data missing somewhere in the
          worksheet.
          <br />
          //GENERATION!!!//
          <br />
          <br />
          <span style="font-weight: bold">Note:</span><br />
          There is no right or wrong way of describe an interaction. Feel free
          to tailor the level of details to suit your purpose and experiment
          with different approaches to find the most effective description.
        </div>
        <select
          id="select_interaction"
          name="interaction_ids"
          style="width: 400px; text-align: center; font-size: 16px"
        >
          <option value="0">--Select an example from the database--</option>
        </select>
        <input
          id="name_interaction"
          style="width: 400px; text-align: center; font-size: 16px"
          placeholder="Please name the current worksheet"
        />
        <button
          class="top_buttons"
          id="submit"
          style="width: 70px; font-size: 16px"
        >
          Save
          <span class="info"
            >Store the current worksheet data with the given name in the
            database. The data will be overwritten if the name already exists in
            the database.
          </span>
        </button>
        <button
          class="top_buttons"
          id="delete"
          style="width: 70px; font-size: 16px; color: crimson"
        >
          Delete
          <span class="info"
            >Remove both the data and the worksheet name from the database. Use
            it only when necessary.
          </span>
        </button>
        <button
          class="top_buttons"
          id="open_new"
          style="float: right; font-size: 16px"
        >
          Open a new worksheet<span
            class="info"
            style="position: absolute; top: 25px; left: -30px"
            >Open an empty worksheet in a new tab.
          </span>
        </button>
      </div>
      <div class="top_block">
        <button class="top_link" id="element_list" onclick="showAll(this)">
          Show all elements
        </button>
        <div id="all_elements"></div>
      </div>
    </div>
    <div id="spacer"></div>
    <div id="input">
      <div
        class="add_element"
        style="
          width: 125px;
          flex-shrink: 0;
          border: 0;
          margin: 0 0 0 10px;
          padding: 2px 0 0 0;
          /* position: sticky;
          left: 0; */
          z-index: 80;
        "
      >
        <!-- annotation -->
        <div class="annotation">
          <div class="anno_block" style="font-size: 20px; font-weight: bold">
            ELEMENT:
            <span class="info"
              >Individual actors in the interaction exhibit the same or similar
              set of behaviours.
            </span>
          </div>
          <div class="anno_block">
            Type:<span class="info"
              >The categorical description helps to differentiate the elements.
              <br />
              <br />
              If an artwork has elements of the same type performing different
              roles, indicate the role of the element after '/'.
            </span>
          </div>
          <div class="anno_block">
            Count:<span class="info"
              >The number of elements of the same type that can simultaneously
              participate in the interaction.
              <br />
              <br />
              A '+' indicates that there is no upper limit on how many elements
              can participate simultaneously.
            </span>
          </div>
          <div
            class="anno_block"
            style="font-size: 20px; font-weight: bold; margin-top: 10px"
          >
            ACTION:<span class="info"
              >Something that is done or performed by the element to other
              element(s) of the same or different type.
              <br />
              <br />
              Either an action is <b>intended</b> for participating in the
              interaction, or its effects are registered by other elements thus
              'forcing' the acting element to participate (<b>unintended</b>).
              Please select the corresponding case.
              <br />
              <br />
              An action can be initiated by the element itself or as a reaction
              to other action(s). Please specify the necessary conditions
              following the action in the form of <b>"If ... do(es) ..."</b>.
              When there are more than three conditions, you can add a
              <b>footnote</b> to specify their order and relationships if
              needed.
              <br />
              <br />
              Please enter the actions and their conditions in a logical or
              chronological order if such relationships are present.
            </span>
          </div>
        </div>
      </div>
      <!-- first element -->
      <div
        class="element"
        onmouseenter="showElementInfo(event, this)"
        onmouseleave="hideElementInfo(this)"
      >
        <button
          class="close"
          name="delete_element"
          onclick="deleteElement(this)"
        >
          X
        </button>
        <div class="element_info"></div>
        <div class="block"><span id="index">#1</span></div>
        <div class="block">
          <input
            list="existTypes"
            id="type"
            placeholder="Type/role (if applicable)"
          /><datalist id="existTypes"></datalist>
        </div>
        <div class="block">
          <input list="eCount" id="ele_num" placeholder="Count" /><datalist
            id="eCount"
          >
            <option value="1"></option>
            <option value="2"></option>
            <option value="3"></option>
            <option value="4"></option>
            <option value="5"></option>
            <option value="1+"></option>
            <option value="2+"></option>
            <option value="3+"></option>
            <option value="4+"></option>
            <option value="5+"></option>
          </datalist>
        </div>
        <div class="allactions">
          <div></div>
          <div class="action">
            <button
              class="close"
              name="delete_action"
              onclick="deleteAction(this)"
            >
              X
            </button>
            <div class="act_block">
              <label for="actionV" id="actionIn">1</label>
              <input list="existAction" id="actionV" placeholder="Action" />
              <datalist id="existAction"></datalist>
            </div>
            <div class="act_block">
              <input
                type="radio"
                id="intentional"
                name="intention"
                value="intentional"
                checked
              /><label for="intentional">Intended</label>
              <input
                type="radio"
                id="unintentional"
                name="intention"
                value="unintentional"
              /><label for="unintentional">Unintended</label>
            </div>
            <div id="condition" style="width: 100%">
              <div class="act_block">
                <span>If</span>
                <select
                  class="if_ele"
                  style="width: 50px"
                  onchange="condition(this)"
                >
                  <option value="">Element</option>
                  <option value="0">Self-initiated</option>
                  <option value="1">#1</option>
                </select>
                <div id="perform" style="display: inline">
                  <span>do(es)</span>
                  <select class="if_act" style="width: 95px">
                    <option value="">Action</option>
                  </select>
                </div>
                <select
                  id="add"
                  style="width: 50px"
                  onchange="addCondition(this)"
                >
                  <option value="">+</option>
                  <option value="0">OR</option>
                  <option value="1">AND</option>
                </select>
              </div>
            </div>
            <div class="act_block">
              <div class="ancom_block" style="margin: 0">
                COMMUNICATION:
                <span class="info"
                  >A form of communication is created when an action is done to
                  an element. An action can be directed at different elements
                  thus creating multiple forms of communication.
                  <br />
                  <br />
                  Please enter the communication in a logical or chronological
                  order if such relationships are present.
                </span>
              </div>
            </div>
            <div class="com">
              <div class="an_com">
                <div class="ancom_block">
                  To:
                  <span class="info"
                    >To which element the action is directed at.
                  </span>
                </div>
                <div class="ancom_block">
                  Means:<span class="info"
                    >The means by which the action reaches the receiving
                    element.
                    <ul>
                      <li>
                        Direct: the action is performed to the receiving element
                        directly without any intermediate element involved.
                      </li>
                      <li>
                        Via (intermediate element): The action is performed to
                        an intermediate element and reaches the receiving
                        element via the intermediate element. This type of
                        communication is often termed mediated communication.
                      </li>
                    </ul>
                  </span>
                </div>
                <div class="ancom_block" style="cursor: default">&nbsp</div>
                <div class="ancom_block" style="margin-top: 8px">
                  Config:<span class="info"
                    >Short for 'configuration'; indicates the number of elements
                    at both ends of the communication.
                    <ul>
                      <li>
                        From: the number of elements it takes to perform the
                        action.
                      </li>
                      <li>
                        To: the number of elements that can receive the
                        communication.
                      </li>
                    </ul>
                  </span>
                </div>
                <div class="ancom_block" style="margin-top: 8px">
                  Count:<span class="info"
                    >The number of communication of the same form that can take
                    place simultaneously.
                  </span>
                </div>
                <div class="ancom_block">
                  Access:<span class="info"
                    >The degree to which the communication is accessible or
                    perceivable to all elements.
                    <ul>
                      <li>
                        Private: the communication can only be perceived by the
                        communicating elements.
                      </li>
                      <li>
                        Public: the communication can also be perceived by
                        elements or spectators beyond the communicating
                        elements.
                      </li>
                    </ul>
                  </span>
                </div>
                <div class="ancom_block" style="cursor: default">&nbsp</div>
                <div class="ancom_block">
                  Effect:<span class="info">The function(s), consequence(s) of the communication, how it influences and relates to the receiving elements.</span>
                </div>
              </div>
              <div class="communications">
                <button class="close" id="delete_com" onclick="deleteCom(this)">
                  X
                </button>
                <div class="block">
                  <select id="to" name="to_elements" style="float: left">
                    <option value="">--To which element--</option>
                    <option value="1">#1</option>
                  </select>
                  <span hidden id="comIn">0</span>
                </div>
                <div class="block">
                  <input
                    type="radio"
                    id="direct_means"
                    name="means"
                    value="direct"
                    checked
                    onclick="checkDirect(this)"
                  /><label for="direct_means">Direct</label>
                </div>
                <div class="block">
                  <input
                    type="radio"
                    id="via_means"
                    name="means"
                    value="via"
                  /><label for="via_means">Via </label>
                  <select id="via" name="via_elements">
                    <option value="">--Select an element--</option>
                    <option value="1">#1</option>
                  </select>
                </div>
                <div class="block">
                  <input
                    list="eCount"
                    id="config_from"
                    placeholder="From"
                  /><span style="font-size: 25px">&rarr;</span
                  ><input list="eCount" id="config_to" placeholder="To" />
                </div>
                <div class="block"><input list="eCount" id="com_num" /></div>
                <div class="block">
                  <input
                    type="radio"
                    id="public_access"
                    name="access"
                    value="public"
                    checked
                  /><label for="public_access">Public</label>
                </div>
                <div class="block">
                  <input
                    type="radio"
                    id="private_access"
                    name="access"
                    value="private"
                  /><label for="private_access">Private</label>
                </div>
                <div class="effect_container">
                  <div
                    class="block"
                    style="position: relative; margin: 3px 3px 0 3px"
                  >
                    <input
                    list = "existEffect"
                    class="effect"
                    ></input>
                    <datalist id="existEffect"></datalist>
                    <button
                      class="close"
                      name="delete_effect"
                      style="
                        width: 13px;
                        height: 15px;
                        font-size: 11px;
                        right: 0;
                      "
                      onclick="deleteEffect(this)"
                    >
                      X
                    </button>
                  </div>
                  <div class="block">
                    <button class="add_effect" onclick="addEffect(this)">
                      +
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <div class="add_communication">
              <button id="add_com" onclick="addCommunication(this)">
                Add communication
              </button>
            </div>
          </div>
          <div class="add_action">
            <button id="add_action" onclick="addAction(this)">
              Add action
            </button>
          </div>
        </div>
      </div>
      <!-- add element -->
      <div class="add_element">
        <button id="add_element" onclick="addElement(this)">Add element</button>
      </div>
    </div>
    <div id="footnote">
      <div
        class="anno_block"
        style="font-weight: bold; text-align: right; margin-right: 2px"
      >
        Footnotes:
      </div>
      <div id="footnote_container"></div>
    </div>
    <!-- <div id="admin_control" style="padding: 10px">
      <button id="saveData">Save Data</button>
      <button id="updateType">Update Element Type</button>
      <button id="updateAction">Update Action List</button>
      <button id="updateEffect">Update Effect List</button>
    </div> -->
    <div id="controls">
      <div class="control_block">
        <button class="control_button" id="visualise">Visualise</button>
      </div>
      <!-- <div class="control_block">
        <button class="control_button" id="randomise">Randomise</button>
      </div>
      <div class="control_block">
        <button class="control_button" id="permutate">Permutate</button>
      </div> -->
    </div>
    <div id="vis">
      <svg id="container" width="1240" height="679"></svg>
      <button id="savePDF">Download</button>
      <svg id="vis_anno" width="250" height="679"></svg>
    </div>
    <!-- <svg id="container" width="960" height="679"></svg> -->
  </body>
</html>
